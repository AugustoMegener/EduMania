<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chat - EduMania</title>
  <link rel="stylesheet" href="/static/base.css">
  <link rel="stylesheet" href="/static/chat-style.css">
  <style>
    :root{
      --bg:#0f1724; /* discord dark bg */
      --panel:#111827;
      --muted:#9ca3af;
      --accent:#5865f2; /* discord blurple */
      --accent-2:#25D366; /* whatsapp green */
      --me-bg:#2d3748;
      --other-bg:#0b1220;
      --text:#e6eef8;
    }

    /* Reset simples */
    *{box-sizing:border-box;margin:0;padding:0;font-family:Inter, 'Segoe UI',
Roboto, Arial, sans-serif}
    html,body,#app{height:100%}
    body{background:var(--bg);color:var(--text)}

    /* Layout */
    .app{display:grid;grid-template-columns:280px 1fr;gap:18px;padding:18px;
height:100vh}
    .sidebar{background:var(--panel);border-radius:12px;overflow:hidden;
display:flex;flex-direction:column}
    .brand{padding:14px 16px;display:flex;align-items:center;gap:12px;
border-bottom:1px solid rgba(255,255,255,0.03)}
    .brand .logo{width:36px;height:36px;border-radius:8px;background:
linear-gradient(135deg,var(--accent),#8a7cff);display:flex;align-items:
center;justify-content:center;font-weight:700}
    .brand h1{font-size:15px}

    .search{padding:10px;border-bottom:1px solid rgba(255,255,255,0.02)}
    .search input{width:100%;padding:8px 10px;border-radius:8px;border:0;
background:#0b1220;color:var(--text)}

    .contacts{padding:8px;overflow:auto}
    .contact{display:flex;align-items:center;gap:10px;padding:8px;
border-radius:8px;cursor:pointer}
    .contact:hover{background:rgba(255,255,255,0.02)}
    .contact.active{background:linear-gradient(90deg, rgba(88,101,242,0.12),
rgba(40,200,120,0.04))}
    .avatar{width:44px;height:44px;border-radius:10px;background:#0b1220;
flex:0 0 44px;display:flex;align-items:center;justify-content:center}
    .meta{flex:1}
    .meta .name{font-weight:600}
    .meta .sub{font-size:12px;color:var(--muted)}

    /* Chat painel */
    .chat{background:linear-gradient(180deg, rgba(255,255,255,0.02),
transparent);border-radius:12px;display:flex;flex-direction:column;overflow:
hidden}
    .chat-header{padding:14px 18px;border-bottom:1px solid rgba(255,255,255,
0.03);display:flex;align-items:center;justify-content:space-between}
    .chat-header .left{display:flex;align-items:center;gap:12px}
    .chat-body{flex:1;padding:20px;overflow:auto;background:radial-gradient(
ellipse at top left, rgba(255,255,255,0.01), transparent)}

    .messages{display:flex;flex-direction:column;gap:12px;max-width:780px}
    .msg{display:inline-block;padding:10px 12px;border-radius:12px;max-width
:70%;line-height:1.3}
    .msg.other{background:rgba(255,255,255,0.03);align-self:flex-start}
    .msg.me{background:var(--me-bg);align-self:flex-end;color:var(--text)}
    .msg .time{display:block;margin-top:6px;font-size:11px;color:var(--muted
);opacity:0.9}

    .chat-input{padding:12px;border-top:1px solid rgba(255,255,255,0.03);
display:flex;gap:10px}
    .chat-input input{flex:1;padding:10px;border-radius:999px;border:0;
background:rgba(255,255,255,0.02);color:var(--text)}
    .btn{padding:8px 12px;border-radius:10px;border:0;cursor:pointer}
    .btn.send{background:var(--accent);color:white}
    .btn.theme{background:transparent;border:1px solid rgba(255,255,255,0.04
);color:var(--text)}

    /* WhatsApp style adjustments (light) */
    .whatsapp { --bg: #e9edef; --panel:#ffffff; --muted:#6b7280; --accent:
#128C7E; --accent-2:#25D366; --me-bg:#DCF8C6; --other-bg:#fff; --text:
#111827 }
    .whatsapp body{background:var(--bg)}

    /* Discord style (default dark) tweaks */
    .discord { --bg:#0f1724; --panel:#0b1220; --muted:#9ca3af; --accent:
#5865f2; --me-bg:#2d3748; --text:#e6eef8 }

    /* Responsive */
    @media (max-width:880px){
      .app{grid-template-columns:1fr}
      .sidebar{order:2}
      .chat{order:1}
    }

  </style>
</head>
<body id="bodyRoot">
  <div class="app" id="app">

    <aside class="sidebar">
      <div class="brand">
        <div class="logo">ES</div>
        <div>
          <h1>Escola Chat</h1>
          <small style="color:var(--muted)">Conecte-se com professores e
colegas</small>
        </div>
      </div>

      <div class="search"><input id="search" placeholder="Pesquisar
contatos..." /></div>

      <div class="contacts" id="contactsList">
        <!-- contatos gerados por JS -->
      </div>

      <div style="margin-top:auto;padding:12px;border-top:1px solid
rgba(255,255,255,0.02);display:flex;gap:8px;align-items:center;justify-content:space-between"
>
        <small style="color:var(--muted)">Tema</small>
        <div>
          <button class="btn btn-secondary theme" id="btnDiscord">Discord</button>
          <button class="btn btn-secondary theme" id="btnWhats">WhatsApp</button>
        </div>
      </div>
    </aside>

    <main class="chat">
      <div class="chat-header">
        <div class="left">
          <div class="avatar" id="chatAvatar">P</div>
          <div>
            <div id="chatName" style="font-weight:700">Professor Pedro</div>
            <div style="font-size:13px;color:var(--muted)">Online</div>
          </div>
        </div>
        <div>
          <small style="color:var(--muted)">Sala: 3º Ano - Mat</small>
        </div>
      </div>

      <div class="chat-body" id="chatBody">
        <div class="messages" id="messages">
          <!-- mensagens de exemplo -->
        </div>
      </div>

      <div class="chat-input">
        <input id="messageInput" placeholder="Escreva uma mensagem...
(Enter para enviar)" />
        <button class="btn send" id="sendBtn">Enviar</button>
      </div>
    </main>

  </div>

  <script>
    // Dados demo
    const contacts = [
      {id:1,name:'Professor Pedro',subtitle:'Matemática',avatar:'P',messages
:[
        {from:'other',text:'Bom dia! A prova é na sexta.',time:'08:03'},
        {from:'me',text:'Ok, obrigado! Qual o conteúdo?',time:'08:05'}
      ]},
      {id:2,name:'Turma 3ºA',subtitle:'Canal da turma',avatar:'3A',messages:
[
        {from:'other',text:'Alguém tem a foto do exercício 4?',time:'09:12'}
      ]},
      {id:3,name:'Diretoria',subtitle:'Avisos',avatar:'D',messages:[
        {from:'other',text:'Reunião amanhã às 18h.',time:'11:30'}
      ]}
    ];

    const contactsList = document.getElementById('contactsList');
    const messagesEl = document.getElementById('messages');
    const chatName = document.getElementById('chatName');
    const chatAvatar = document.getElementById('chatAvatar');
    const bodyRoot = document.getElementById('bodyRoot');

    let active = contacts[0];

    function renderContacts(filter=''){
      contactsList.innerHTML = '';
      contacts.filter(c => c.name.toLowerCase().includes(filter.toLowerCase
())).forEach(c =>{
        const div = document.createElement('div');
        div.className = 'contact' + (c.id===active.id ? ' active' : '');
        div.innerHTML = `<div class="avatar">${c.avatar}</div><div
class="meta"><div class="name">${c.name}</div><div class="sub">${c.subtitle}
</div></div>`;
        div.onclick = ()=>{ setActive(c.id) };
        contactsList.appendChild(div);
      })
    }

    function renderMessages(){
      messagesEl.innerHTML='';
      if(!active) return;
      chatName.textContent = active.name;
      chatAvatar.textContent = active.avatar;
      active.messages.forEach(m=>{
        const d = document.createElement('div');
        d.className = 'msg '+(m.from==='me' ? 'me' : 'other');
        d.innerHTML = `<div>${escapeHtml(m.text)}</div><span class="time">${
m.time}</span>`;
        messagesEl.appendChild(d);
      });
      // rolar para baixo
      setTimeout(()=>document.getElementById('chatBody').scrollTop =
document.getElementById('chatBody').scrollHeight,50);
    }

    function setActive(id){
      active = contacts.find(c=>c.id===id) || contacts[0];
      renderContacts(document.getElementById('search').value);
      renderMessages();
    }

    function escapeHtml(str){
      return (str+'').replace(/[&<>"']/g, function(m){return {'&':'&amp;',
'<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[m]});
    }

    // envio de mensagem simples
    function sendMessage(){
      const input = document.getElementById('messageInput');
      const text = input.value.trim();
      if(!text) return;
      const now = new Date();
      const t = now.getHours().toString().padStart(2,'0')+':'+now.getMinutes
().toString().padStart(2,'0');
      active.messages.push({from:'me',text, time: t});
      input.value='';
      renderMessages();
    }

    document.getElementById('sendBtn').addEventListener('click', sendMessage
);
    document.getElementById('messageInput').addEventListener('keydown', e=>{
if(e.key==='Enter') sendMessage(); });
    document.getElementById('search').addEventListener('input', e=>
renderContacts(e.target.value));

    // temas
    document.getElementById('btnDiscord').addEventListener('click', ()=>{
document.body.className='discord'; });
    document.getElementById('btnWhats').addEventListener('click', ()=>{
document.body.className='whatsapp'; });

    // Inicializar
    renderContacts();
    renderMessages();
  </script>
</body>
</html>
